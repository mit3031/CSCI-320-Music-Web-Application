<!--
The results screen for a popularity listing
It's just search/results.html with the sorting removed, so it's barely my own work
Author: Joseph Britton (jtb8595)
-->

{% extends "base.html" %}
{% block title %}Popular Songs{% endblock %}

{% block content %}
<div style="max-width: 1000px; margin: 50px auto; padding: 25px; border-radius: 12px; background-color: #f9f9f9; box-shadow: 0 6px 12px rgba(0,0,0,0.08);">
    <h2 style="text-align: center; margin-bottom: 25px; font-weight: 700;">Popular Songs</h2>

    <!-- Popular songs table -->
    <div style="overflow-x:auto;">
    <table style="width: 100%; border-collapse: collapse; text-align: center;">
    <thead style="background-color: #007BFF; color: white; font-weight: 600;">
        <tr>
            <th style="padding: 10px; border-radius: 8px 8px 0 0;">Song Name</th>
            <th>Artist</th>
            <th>Album</th>
            <th>Genre</th>
            <th>Length</th>
            <th>Release Date</th>
            <th>Listens</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for song in results %}
        <tr style="border-bottom: 1px solid #ddd;">
            <td>{{ song.get('name', '—') }}</td>
            <td>{{ song.get('artist', '—') }}</td>
            <td>{{ song.get('album', '—') }}</td>
            <td>{{ song.get('genre', '—') }}</td>
            <td>{{ song.get('length', '—') }}</td>
            <td>{{ song.get('release_date', '—') }}</td>
            <td>{{ song.get('listen_count', 0) }}</td>
            <td style="display: flex; gap: 6px; justify-content: center; flex-wrap: wrap;">
                <form action="{{ url_for('popular.play_song', song_id=song['song_id']) }}" method="POST">
                    <input type="hidden" name="next" value="{{ request.path }}">
                    <button type="submit" style="padding: 6px 10px; border-radius: 50px; border: none; background-color: #28a745; color: white; font-weight: 500; cursor: pointer;">▶ Play</button>
                </form>
                <form action="{{ url_for('collections.add_track_view', song_id=song['song_id']) }}" method="POST"> <!-- Placeholder button -->
                    <button type="submit" style="padding: 6px 10px; border-radius: 50px; border: 1px solid #007BFF; background-color: white; color: #007BFF; font-weight: 500; cursor: pointer;">Add To Collections</button>
                </form>
            </td>
        </tr>
        {% else %}
        <tr>
            <td colspan="8" style="padding: 12px; color: #6c757d;">No results found.</td>
        </tr>
        {% endfor %}
    </tbody>
    </table>
    </div>

    <!-- Navigation back to home page -->
    <div style="text-align: center; margin-top: 25px;">
        <a href="{{ url_for('popular.songs_popular') }}" style="padding: 10px 20px; border-radius: 50px; border: 1px solid #343a40; color: #343a40; text-decoration: none;">← Back to Popular</a>
    </div>
</div>
{% endblock %}